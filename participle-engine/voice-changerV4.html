<!DOCTYPE html>
<html lang="">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Voice Change Helper Version 3</title>
    <style>
		body{text-align: left;}
		.activeHelp{ color: blue;}
		.passiveOutput{color: rebeccapurple;}
	</style>
</head>

<body>
    
    <div class="activeInput"> 
    <span class="activeHelp">Subject : (such as Soumen, You) </span><br>   
	<input type="text" id="subject1" onkeyup="update()" ><br>
		   
	<span class="activeHelp">Verb: (such as sees, eat) </span><br>   
	<input type="text" id="verb" onkeyup="update()" ><br>

	<span class="activeHelp">Object (such as elephant, Peter) </span><br>  
	<input type="text" id="object1" onkeyup="update()" >
    </div>
    <br>
    
    <span >Passive Output</span><br>
    <div class="passiveOutput">    
		<span id="object2" > </span>		 

		<span  id="displayParticiple"> </span>
		
		<span id="prep">by</span>

		<span id="subject2"> </span>
    </div>
    
    <span id="numbertest">Number test</span>
    
   
    <script src="participle-engine-script/participle-engine.js"></script> 
    <script>
		
		const SINGULAR=1; const PLURAL=2; const IDK=3;
		 let currentnumber=SINGULAR;
		
        function update(){
			
			currentnumber = guessNumber(cleaninput( e("object1").value.toLowerCase() ) );
			
			if( currentnumber === SINGULAR){e("numbertest").style.backgroundColor= "green";}
			if ( currentnumber === PLURAL)   {e("numbertest").style.backgroundColor= "red";}
			if ( currentnumber === IDK)   {e("numbertest").style.backgroundColor= "yellow";}
				
			/*----------------------------------------------------------*/
			
            
			let msg=   e("verb").value.toLowerCase().replace(/^\s+/,"").replace(/\s+$/,"");
			e("displayParticiple").innerHTML =  msg? makeparticiple( msg ): " (...) ";
			
			e("subject2").innerHTML = e("subject1").value;
			
			e("object2").innerHTML = e("object1").value;
			
						
			
			if(e("displayParticiple").value.toLowerCase() ==="known"){
				e("prep").innerHTML = "to";
			}else e("prep").innerHTML = "by";
		} 
		
		function guessNumber(word){
								
			let plurals = {mice:1,men:1,women:1,people:1,children:1,geese:1,teeth:1,oxen:1};
			let AMBIGUOUS = {deer:1, moose:1, series:1, swine:1, salmon:1, means:1, aircraft:1, offspring:1, species:1, grapefruit:1,sheep:1,fish:1,shrimp:1};
			
			if(/^a\sfew/.test(word) ){return PLURAL;}
			if(/^the\sfew/.test(word) ){return PLURAL;}
			if(/^a\s/.test(word) ) { return SINGULAR;}
			if(/^an\s/.test(word) ){ return SINGULAR; }
			if(/s$/.test(word) ){return PLURAL;}
			if(/^many\s/.test(word) ){return PLURAL;}
			if(/^most\s/.test(word) ){return PLURAL;}
			if(/^some\s/.test(word) ){return PLURAL;}
			
			if(/^all\s/.test(word) ){return PLURAL;}
			
			if( plurals[word]){return PLURAL;}
			if( AMBIGUOUS[word]){return IDK;}
			if( word === "elephant"){return SINGULAR; }
			
			return SINGULAR;
		}
		
		function cleaninput(input){return input.replace(/^\s+/,"").replace(/\s+$/,"").replace(/\s\s+$/g," ");}
		
        function e(id){return document.getElementById(id);}
    </script>
</body>
</html>
